<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="mui-0.9.42/css/mui.css" rel="stylesheet" type="text/css" />
    <link href="index.css" rel="stylesheet" type="text/css" />
    <script src="mui-0.9.42/js/mui.js"></script>

    <title>Sesame</title>
</head>

<body class="hide-sidedrawer">
    <div id="main-container" class="mui-container">
        <div class="mui-panel">
            <form class="mui-form" method="POST">
                <legend id='legend'>Welcome to sign-in</legend>
                <div class="mui-textfield">
                    <input name="login" type="text" autofocus placeholder="name">
                </div>
                <div class="mui-textfield">
                    <input name="password" type="password" placeholder="password">
                </div>

                <input id="redirect_uri" name="redirect_uri" type="hidden" value="">
                <button type="submit" class="mui-btn mui-btn--raised">Connect</button>
            </form>
        </div>
    </div>

    <script>
        const params = (function () {
            const params = {}
            const query = window.location.search.substr(1)
            for (const part of query.split("&")) {
                let idx = part.indexOf('=')
                if (idx <= 0)
                    continue
                let name = part.substr(0, idx)
                let value = part.substr(idx + 1)

                params[name] = value
            }
            return params
        })()

        window.onload = () => {
            document.getElementById("redirect_uri").value = params["redirect_uri"]
            if (params["message"] == "error")
                document.getElementById("legend").innerHTML += ` (retry)`
        }
    </script>
</body>

</html>